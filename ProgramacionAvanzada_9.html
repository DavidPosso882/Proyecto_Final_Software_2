<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Programaci贸n Avanzada | Gu铆as y material de clase del espacio acad茅mico Programaci贸n Avanzada.</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Programaci贸n Avanzada" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Gu铆as y material de clase del espacio acad茅mico Programaci贸n Avanzada." />
<meta property="og:description" content="Gu铆as y material de clase del espacio acad茅mico Programaci贸n Avanzada." />
<link rel="canonical" href="https://caflorezvi.github.io/guias-programacion-avanzada/9.representacion-informacion.html" />
<meta property="og:url" content="https://caflorezvi.github.io/guias-programacion-avanzada/9.representacion-informacion.html" />
<meta property="og:site_name" content="Programaci贸n Avanzada" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Programaci贸n Avanzada" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Gu铆as y material de clase del espacio acad茅mico Programaci贸n Avanzada.","headline":"Programaci贸n Avanzada","url":"https://caflorezvi.github.io/guias-programacion-avanzada/9.representacion-informacion.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/guias-programacion-avanzada/assets/css/style.css?v=12926fa7e43f9584a9f4f82f3d029693a64a6a39">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/guias-programacion-avanzada/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="https://caflorezvi.github.io/guias-programacion-avanzada/">Programaci贸n Avanzada</a></h1>
      

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Programa de Ingenier铆a de Sistemas y Computaci贸n
Universidad del Quind铆o

T铆tulo: Entidades para la Representaci贸n de Informaci贸n
Duraci贸n estimada: 120
Docentes: Carlos Andr茅s Florez, Christian Andr茅s Candela
Gu铆a: 09
</code></pre></div></div>
<hr />

<h1 id="entidades-para-la-representaci贸n-de-la-informaci贸n">Entidades para la representaci贸n de la informaci贸n</h1>

<h2 id="-objetivo"> Objetivo</h2>

<p>Comprender el concepto de <strong>entidad</strong> en Spring Boot y su relaci贸n con las <strong>tablas</strong> en las bases de datos relacionales, aplicando buenas pr谩cticas de modelado de datos para aplicaciones SQL.</p>

<hr />

<h2 id="conceptos-b谩sicos">Conceptos B谩sicos</h2>

<ul>
  <li><strong>Base de datos</strong>: Conjunto de datos estructurados que se almacenan y gestionan de manera eficiente.</li>
  <li><strong>JSON</strong>: Formato de intercambio de datos ligero.</li>
  <li><strong>POO</strong>: Programaci贸n Orientada a Objetos en Java.</li>
  <li><strong>Spring Data JPA</strong>: M贸dulo de Spring para integraci贸n con bases de datos relacionales.</li>
  <li><strong>Java:</strong> Lenguaje de programaci贸n orientado a objetos.</li>
</ul>

<hr />

<h2 id="contextualizaci贸n-te贸rica">Contextualizaci贸n Te贸rica</h2>

<p>En el desarrollo de aplicaciones, es com煤n que los datos generados y utilizados por la aplicaci贸n necesiten ser almacenados de manera permanente para su posterior recuperaci贸n y uso. Tradicionalmente, esto se ha logrado mediante bases de datos relacionales, en las cuales los datos se organizan en tablas con filas y columnas. Sin embargo, los lenguajes de programaci贸n orientados a objetos (OOP) como Java trabajan con estructuras de datos representadas mediante clases y objetos, lo que genera una disparidad entre la forma en que se almacenan y manipulan los datos en la aplicaci贸n y en la base de datos.</p>

<p>Para interactuar con bases de datos relacionales, los desarrolladores sol铆an escribir consultas SQL manuales dentro del c贸digo de la aplicaci贸n, lo que llevaba a problemas como:</p>

<ul>
  <li><strong>Acoplamiento entre l贸gica de negocio y acceso a datos</strong>: La mezcla de SQL dentro del c贸digo hac铆a dif铆cil la mantenibilidad y escalabilidad.</li>
  <li><strong>Errores comunes de seguridad</strong>: Como inyecciones SQL debido al uso inadecuado de concatenaciones de strings.</li>
  <li><strong>Inconsistencia en las consultas</strong>: Diferentes partes del c贸digo pod铆an manejar la misma consulta de formas distintas.</li>
  <li><strong>Dificultad en la migraci贸n de bases de datos</strong>: Al cambiar de base de datos, se requer铆a modificar todas las consultas SQL escritas manualmente.</li>
  <li><strong>Inconsistencia de datos</strong> al mapear objetos a tablas.</li>
  <li><strong>Acoplamiento</strong> entre l贸gica de negocio y acceso a datos.</li>
</ul>

<p>Para solucionar estos problemas, surgieron los frameworks de mapeo objeto-relacional (ORM) y los Object-Document Mapping (ODM), que permiten gestionar la persistencia de datos de manera transparente y eficiente.</p>

<h3 id="orm-object-relational-mapping">ORM (Object-Relational Mapping)</h3>

<p>El mapeo objeto-relacional (ORM, por sus siglas en ingl茅s) es una t茅cnica de programaci贸n que permite interactuar con bases de datos relacionales utilizando objetos en un lenguaje de programaci贸n orientado a objetos, como Java. ORM permite que los desarrolladores trabajen con estructuras de datos sin escribir directamente consultas SQL, ya que el framework ORM se encarga de traducir las operaciones de los objetos a comandos SQL subyacentes.</p>

<p>Los principales beneficios del uso de ORM incluyen:</p>

<ul>
  <li><strong>Abstracci贸n del acceso a datos</strong>: Facilita la escritura y mantenimiento del c贸digo.</li>
  <li><strong>Reducci贸n de errores</strong>: Al evitar SQL manual, se minimizan los errores comunes.</li>
  <li><strong>Compatibilidad con m煤ltiples bases de datos</strong>: Permite cambiar de base de datos con menor esfuerzo.</li>
  <li><strong>Gesti贸n de transacciones y cach茅</strong>: ORM maneja transacciones autom谩ticamente y mejora el rendimiento mediante cach茅.</li>
</ul>

<p>Ejemplos populares de frameworks ORM en Java incluyen Hibernate (que implementa JPA), EclipseLink entre otros.</p>

<h3 id="jpa-java-persistence-api">JPA (Java Persistence API)</h3>

<p>JPA es una especificaci贸n de Java para la gesti贸n de persistencia y mapeo objeto-relacional. No es una implementaci贸n en s铆, sino un conjunto de reglas y anotaciones que permiten definir entidades y gestionar su almacenamiento en bases de datos relacionales. Hibernate es la implementaci贸n de JPA m谩s utilizada en Java.</p>

<p>JPA proporciona diversas anotaciones para definir entidades, sus atributos y relaciones. A continuaci贸n, se presentan las m谩s comunes:</p>

<p><strong>1. <code class="language-plaintext highlighter-rouge">@Entity</code></strong></p>

<p>Una entidad es un elemento de persistencia, que permite modelar o representar un objeto o informaci贸n del sistema que estamos construyendo. Toda entidad est谩 compuesta por uno o m谩s atributos, cada uno de los cuales representa una propiedad o informaci贸n del objeto que se est谩 modelando.</p>

<p>La anotaci贸n <code class="language-plaintext highlighter-rouge">@Entity</code> se usa para marcar una clase como una entidad que se mapear谩 a una tabla en la base de datos.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">jakarta.persistence.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.persistence.Id</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fullName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>2. <code class="language-plaintext highlighter-rouge">@Table</code></strong></p>

<p>Permite definir el nombre de la tabla en la base de datos. Si no se especifica, JPA utilizar谩 el nombre de la clase como nombre de la tabla.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">jakarta.persistence.Table</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"users"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fullName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>3. <code class="language-plaintext highlighter-rouge">@Id</code> y <code class="language-plaintext highlighter-rouge">@GeneratedValue</code></strong></p>

<p>Se usan para definir la clave primaria de la entidad y la estrategia de generaci贸n del identificador.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">jakarta.persistence.GeneratedValue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.persistence.GenerationType</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fullName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>La anotaci贸n <code class="language-plaintext highlighter-rouge">@GeneratedValue</code> se utiliza para especificar c贸mo se generar谩 el valor de la clave primaria. En este caso, se est谩 utilizando la estrategia <code class="language-plaintext highlighter-rouge">IDENTITY</code>, que permite que la base de datos genere autom谩ticamente el valor del identificador.</p>

<p><strong>4. <code class="language-plaintext highlighter-rouge">@Column</code></strong></p>

<p>Personaliza las propiedades de un atributo en la base de datos, como su nombre, restricciones y opciones de mapeo.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">jakarta.persistence.Column</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"full_name"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">100</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fullName</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">unique</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>5. <code class="language-plaintext highlighter-rouge">@ManyToOne</code>, <code class="language-plaintext highlighter-rouge">@OneToMany</code>, <code class="language-plaintext highlighter-rouge">@OneToOne</code>, <code class="language-plaintext highlighter-rouge">@ManyToMany</code></strong></p>

<p>Estas anotaciones definen relaciones entre entidades. Por medio de estas anotaciones, se establecen las llaves for谩neas y las relaciones de asociaci贸n entre las tablas en la base de datos.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    
    <span class="nd">@ManyToOne</span> <span class="c1">// Cada orden pertenece a un solo usuario. Este campo es la llave for谩nea.</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"user"</span><span class="o">)</span> <span class="c1">// Un usuario puede tener m煤ltiples 贸rdenes. Este campo no se mapea en la base de datos.</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>En esta relaci贸n, un usuario puede tener m煤ltiples 贸rdenes, pero cada orden pertenece a un solo usuario. Otro aspecto importante es que las relaciones entre entidades pueden ser <strong>unidireccionales o bidireccionales</strong>. Para el ejemplo anterior, la relaci贸n es bidireccional porque ambas entidades (<code class="language-plaintext highlighter-rouge">User</code> y <code class="language-plaintext highlighter-rouge">Order</code>) tienen una referencia a la otra. Esto permite navegar desde un usuario a sus 贸rdenes y viceversa.</p>

<p>Las relaciones bidireccionales son 煤tiles cuando se necesita acceder a los datos desde ambos lados de la relaci贸n. Sin embargo, tambi茅n pueden aumentar la complejidad del modelo y el rendimiento, por lo que es importante evaluar si realmente se necesita una relaci贸n bidireccional en cada caso.</p>

<hr />

<h2 id="precauciones-y-recomendaciones">Precauciones y Recomendaciones</h2>

<ul>
  <li>Recuerde verificar que tiene instalado el JDK de Java (preferiblemente la versi贸n 21).</li>
  <li>Aseg煤rese tener el servidor de base de datos en ejecuci贸n.</li>
  <li>Se recomienda que primero se haga un <strong>diagrama de clases</strong> para visualizar la estructura de las entidades y sus relaciones.</li>
</ul>

<hr />

<h2 id="evaluaci贸n-o-resultado">Evaluaci贸n o Resultado</h2>

<p>Se espera que el estudiante logre modelar entidades l贸gicas de una aplicaci贸n y que por medio de ellas se generen las colecciones correspondientes en la base de datos que las representen de forma adecuada.</p>

<hr />

<h2 id="procedimiento">Procedimiento</h2>

<p>Continuaremos trabajando en el proyecto final del espacio acad茅mico que iniciamos en las gu铆as anteriores. Si no ha completado la gu铆a anterior, por favor h谩galo antes de continuar con esta.</p>

<h3 id="1-configuraci贸n-inicial">1. Configuraci贸n inicial</h3>

<p>Agregue las siguientes dependencias en el archivo <code class="language-plaintext highlighter-rouge">build.gradle</code> para incluir Spring Data JPA y el conector de MariaDB:</p>

<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="s1">'org.springframework.boot:spring-boot-starter-data-jpa'</span>
<span class="n">runtimeOnly</span> <span class="s1">'org.mariadb.jdbc:mariadb-java-client'</span>
</code></pre></div></div>

<p>Sincronice Gradle para que descargue la dependencia.</p>

<h3 id="2-modificar-archivo-applicationproperties">2. Modificar archivo <code class="language-plaintext highlighter-rouge">application.properties</code></h3>

<p>Agregue la siguiente configuraci贸n en el archivo <code class="language-plaintext highlighter-rouge">src/main/resources/application.properties</code>:</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Configuraci贸n datasource
</span><span class="py">spring.datasource.url</span><span class="p">=</span><span class="s">jdbc:mariadb://localhost:3306/booking</span>
<span class="py">spring.datasource.username</span><span class="p">=</span><span class="s">root</span>
<span class="py">spring.datasource.password</span><span class="p">=</span><span class="s">su_contrase帽a</span>
<span class="py">spring.datasource.driver-class-name</span><span class="p">=</span><span class="s">org.mariadb.jdbc.Driver</span>

<span class="c"># Configuraci贸n JPA/Hibernate
</span><span class="py">spring.jpa.hibernate.ddl-auto</span><span class="p">=</span><span class="s">update</span>
<span class="py">spring.jpa.show-sql</span><span class="p">=</span><span class="s">true</span>
</code></pre></div></div>

<p>El archivo <code class="language-plaintext highlighter-rouge">application.properties</code> es fundamental en un proyecto de Spring. En este archivo se define la configuraci贸n de una aplicaci贸n, como por ejemplo, la conexi贸n a la base de datos, el uso de modo debug para hacer un logging m谩s detallado, entre otras cosas. Para conocer m谩s sobre las propiedades que se pueden usar, podemos visitar <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/appendix-application-properties.html">la documentaci贸n oficial de Spring Boot</a>.</p>

<p>En nuestro caso, el archivo de propiedades, tiene los datos de conexi贸n a la base de datos de MariaDB. Es decir, nos vamos a conectar a la base de datos con el nombre <code class="language-plaintext highlighter-rouge">booking</code> que est谩 en el puerto <code class="language-plaintext highlighter-rouge">3306</code> (que es el puerto por defecto de MariaDB) en <code class="language-plaintext highlighter-rouge">localhost</code>.</p>

<blockquote>
  <p>锔 <strong>Importante:</strong> Puede cambiar el nombre de la base de datos, el usuario y la contrase帽a seg煤n su configuraci贸n.</p>
</blockquote>

<h3 id="3-crear-la-base-de-datos-en-mariadb">3. Crear la base de datos en MariaDB</h3>

<p>Para crear la base de datos en MariaDB, debe ingresar al cliente de MariaDB y ejecutar el siguiente comando:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">booking</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="4-crear-entidades">4. Crear Entidades</h3>

<p>A continuaci贸n, crearemos las entidades que representar谩n las tablas en nuestra base de datos. Ub铆quese en la carpeta <code class="language-plaintext highlighter-rouge">main/java</code> y en el paquete <code class="language-plaintext highlighter-rouge">co.edu.uniquindio.application.model</code>, cree las siguientes clases:</p>

<h4 id="entidad-user">Entidad <code class="language-plaintext highlighter-rouge">User</code></h4>

<p>Si a煤n no la tiene, cree la clase <code class="language-plaintext highlighter-rouge">User</code> que representar谩 a los usuarios de nuestra aplicaci贸n. Debe quedar as铆:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">co.edu.uniquindio.application.model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">co.edu.uniquindio.application.model.enums.Role</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">co.edu.uniquindio.application.model.enums.UserStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.persistence.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Entity</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">phone</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">photoUrl</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">dateBirth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Role</span> <span class="n">role</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">UserStatus</span> <span class="n">status</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Se agrega la anotaci贸n <code class="language-plaintext highlighter-rouge">@Entity</code> para indicar que esta clase es una entidad de JPA. Tambi茅n se han agregado las anotaciones <code class="language-plaintext highlighter-rouge">@NoArgsConstructor</code> y <code class="language-plaintext highlighter-rouge">@AllArgsConstructor</code> para generar constructores sin argumentos y con todos los argumentos, respectivamente. Esto es 煤til para la creaci贸n de instancias de la entidad.</p>

<p>Adem谩s, es recomendable utilizar la anotaci贸n <code class="language-plaintext highlighter-rouge">@Builder</code> para facilitar la creaci贸n de instancias de la entidad de manera m谩s legible y mantenible.</p>

<blockquote>
  <p>锔 <strong>Importante:</strong> Es obligatorio tener un constructor sin argumentos en las entidades de JPA. Esto lo logramos con la anotaci贸n <code class="language-plaintext highlighter-rouge">@NoArgsConstructor</code> de Lombok.</p>
</blockquote>

<p><strong>Restricciones de los campos:</strong></p>

<p>Es una buena pr谩ctica definir las restricciones de las propiedades de la entidad, como por ejemplo, la longitud m谩xima de un campo o si un campo es obligatorio, etc. Por ejemplo:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">co.edu.uniquindio.application.model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">co.edu.uniquindio.application.model.enums.Role</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">co.edu.uniquindio.application.model.enums.UserStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">jakarta.persistence.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Entity</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@Builder</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">15</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">phone</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">100</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">200</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">photoUrl</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">dateBirth</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Role</span> <span class="n">role</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">UserStatus</span> <span class="n">status</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Al mapear la entidad a la tabla <code class="language-plaintext highlighter-rouge">user</code>, se crear谩n en la base de datos las columnas correspondientes con las restricciones especificadas en las anotaciones <code class="language-plaintext highlighter-rouge">@Column</code>. En este caso, se han definido propiedades como <code class="language-plaintext highlighter-rouge">length</code>, para establecer la longitud m谩xima de los campos, y <code class="language-plaintext highlighter-rouge">nullable</code>, para indicar si un campo es obligatorio o puede quedar vac铆o.</p>

<p><strong>Uso de Enums</strong></p>

<p>Para los campos que tienen un conjunto limitado de valores, como <code class="language-plaintext highlighter-rouge">role</code> o <code class="language-plaintext highlighter-rouge">status</code>, es recomendable utilizar un <code class="language-plaintext highlighter-rouge">enum</code>. Esto ayuda a garantizar que solo se utilicen valores v谩lidos para ese campo. JPA soporta el mapeo de enums a columnas de la base de datos.</p>

<p>Si un usuario puede tener m煤ltiples roles, se podr铆a utilizar una colecci贸n:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ElementCollection</span> <span class="c1">// Indica que es una colecci贸n de elementos b谩sicos</span>
<span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Role</span><span class="o">&gt;</span> <span class="n">roles</span><span class="o">;</span>
</code></pre></div></div>

<h4 id="entidad-review">Entidad <code class="language-plaintext highlighter-rouge">Review</code></h4>

<p>La entidad <code class="language-plaintext highlighter-rouge">Review</code>, con sus campos y restricciones, puede quedar de la siguiente manera:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">co.edu.uniquindio.application.model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">jakarta.persistence.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@Builder</span>
<span class="nd">@Getter</span> <span class="nd">@Setter</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Review</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span> <span class="c1">// Genera el id autom谩ticamente en la base de datos</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span> <span class="c1">//Llave for谩nea a la entidad User</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>

    <span class="nd">@Lob</span> <span class="c1">// Sirve para textos largos</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">comment</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">rating</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<p>El atributo <code class="language-plaintext highlighter-rouge">id</code> para esta entidad es de tipo <code class="language-plaintext highlighter-rouge">Long</code> y se genera autom谩ticamente en la base de datos utilizando la estrategia <code class="language-plaintext highlighter-rouge">IDENTITY</code>. Esto implica que la base de datos se encargar谩 de asignar un valor 煤nico a este campo cada vez que se cree una nueva rese帽a.</p>

<p>Como se mencion贸 anteriormente, las relaciones entre entidades deben definirse usando las anotaciones de JPA correspondientes. Por ejemplo:</p>

<ul>
  <li>Se usa la anotaci贸n <code class="language-plaintext highlighter-rouge">@ManyToOne</code> para establecer una relaci贸n de muchos a uno entre <code class="language-plaintext highlighter-rouge">Review</code> y <code class="language-plaintext highlighter-rouge">User</code>, lo que significa que un usuario puede hacer m煤ltiples rese帽as, pero una rese帽a solo puede pertenecer a un usuario.</li>
  <li>No se define la relaci贸n inversa en la entidad <code class="language-plaintext highlighter-rouge">User</code> para mantener la simplicidad y evitar complejidades innecesarias. Ya que <strong>no es necesario conocer las rese帽as</strong> desde el usuario en este caso.</li>
</ul>

<p>Adem谩s, se usa la anotaci贸n <code class="language-plaintext highlighter-rouge">@JoinColumn</code> para especificar restricciones en la columna que representa la llave for谩nea.</p>

<h3 id="5-ejecuci贸n-del-proyecto">5. Ejecuci贸n del proyecto</h3>

<p>Ejecute la aplicaci贸n Spring Boot y verifique que no haya errores en la consola. Luego, vaya al cliente de MariaDB y verifique que las tablas se hayan creado correctamente.</p>

<h3 id="6-cree-la-entidad-place-y-sus-relaciones">6. Cree la entidad <code class="language-plaintext highlighter-rouge">Place</code> y sus relaciones</h3>

<p>Con base en la especificaci贸n del proyecto final, cree la entidad <code class="language-plaintext highlighter-rouge">Place</code> con sus respectivos atributos y relaciones. Tenga en cuenta lo siguiente:</p>

<ul>
  <li>La entidad <code class="language-plaintext highlighter-rouge">Review</code> debe tener una relaci贸n de muchos a uno (<code class="language-plaintext highlighter-rouge">@ManyToOne</code>) con la entidad <code class="language-plaintext highlighter-rouge">Place</code>, ya que un lugar puede tener m煤ltiples rese帽as, pero una rese帽a solo puede pertenecer a un lugar.</li>
  <li>La entidad <code class="language-plaintext highlighter-rouge">Place</code> debe tener una relaci贸n de uno a muchos (<code class="language-plaintext highlighter-rouge">@OneToMany</code>) con la entidad <code class="language-plaintext highlighter-rouge">Review</code>, ya que puede ser 煤til conocer las rese帽as asociadas a un lugar. En este caso debe crear una lista de rese帽as en la entidad <code class="language-plaintext highlighter-rouge">Place</code> y usar la propiedad <code class="language-plaintext highlighter-rouge">mappedBy</code> para indicar que la relaci贸n es bidireccional y que la entidad <code class="language-plaintext highlighter-rouge">Review</code> es la propietaria de la relaci贸n.</li>
</ul>

<p><strong>Ejemplo:</strong></p>

<p>La relaci贸n en la entidad <code class="language-plaintext highlighter-rouge">Review</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Review</span> <span class="o">{</span>
    <span class="c1">// Otros atributos...</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Place</span> <span class="n">place</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Y la relaci贸n inversa en la entidad <code class="language-plaintext highlighter-rouge">Place</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Place</span> <span class="o">{</span>
    <span class="c1">// Otros atributos...</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"place"</span><span class="o">)</span> <span class="c1">// Indica que la relaci贸n es bidireccional y que Review es la propietaria</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Review</span><span class="o">&gt;</span> <span class="n">reviews</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Identifique qu茅 otras relaciones son necesarias en la entidad <code class="language-plaintext highlighter-rouge">Place</code> y def铆nalas adecuadamente.</p>

<h3 id="7-creaci贸n-de-las-entidades-del-proyecto-final">7. Creaci贸n de las entidades del proyecto final</h3>

<p>Cree todas las entidades necesarias para el proyecto final. Aseg煤rese de incluir las anotaciones adecuadas y de seguir las mejores pr谩cticas de dise帽o de entidades.</p>

<h3 id="8-confirmar-cambios-en-git">8. Confirmar cambios en Git</h3>

<p>Recuerde agregar los archivos modificados y nuevos al repositorio de git y hacer commit.</p>

<hr />

<h2 id="para-la-pr贸xima-clase">Para la pr贸xima clase</h2>

<ul>
  <li>Revise la gu铆a de Spring Data JPA en la documentaci贸n oficial: <a href="https://spring.io/projects/spring-data-jpa">Spring Data JPA</a>.</li>
  <li>Investigue sobre las diferentes estrategias de generaci贸n de claves primarias en JPA, como <code class="language-plaintext highlighter-rouge">IDENTITY</code>, <code class="language-plaintext highlighter-rouge">SEQUENCE</code>, <code class="language-plaintext highlighter-rouge">TABLE</code> y <code class="language-plaintext highlighter-rouge">AUTO</code>.</li>
  <li>Investigar sobre las anotaciones <code class="language-plaintext highlighter-rouge">@Embeddable</code> y <code class="language-plaintext highlighter-rouge">@Embedded</code> en JPA y c贸mo se utilizan para definir componentes embebidos en entidades.</li>
</ul>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
